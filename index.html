<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Training Log</title>
<style>
body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 10px; }
h2 { margin-top: 30px; }
table { border-collapse: collapse; width: 100%; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 6px; font-size: 12px; text-align: center; }
th { background: #f0f0f0; }
.section { margin-bottom: 40px; }
</style>
</head>
<body>

<h1>トレーニング記録</h1>

<div class="section">
<h2>① トレーニング履歴</h2>
<table id="logTable">
<thead>
<tr>
<th>日付</th>
<th>種目</th>
<th>重量</th>
<th>回数</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="section">
<h2>② 種目ごとの最高重量</h2>
<table id="maxWeightTable">
<thead>
<tr>
<th>種目</th>
<th>重量</th>
<th>回数</th>
<th>日付</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="section">
<h2>③ 重量ごとの最高回数</h2>
<table id="repMaxTable">
<thead>
<tr>
<th>種目</th>
<th>重量</th>
<th>最高回数</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
const rawData = [
  {d:"3/30", n:"スクワット", w:12, r:10},
  {d:"3/30", n:"スクワット", w:12, r:10},
  {d:"3/30", n:"プレスダウン", w:10, r:10},
  {d:"3/30", n:"プレスダウン", w:15, r:10},
  {d:"3/30", n:"プレスダウン", w:15, r:10},
  {d:"3/30", n:"アブドミナル", w:15, r:10},
  {d:"3/30", n:"アブドミナル", w:15, r:10},
  {d:"3/30", n:"アブドミナル", w:15, r:10},
  {d:"8/31", n:"ラットプルダウン", w:20, r:15},
  {d:"10/26", n:"インクラインベンチプレス", w:17, r:12},
  {d:"11/12", n:"ラットプルダウン", w:20, r:12}
];

localStorage.setItem("trainingData", JSON.stringify(rawData));
const data = JSON.parse(localStorage.getItem("trainingData"));

const logBody = document.querySelector("#logTable tbody");
data.forEach(e=>{
  logBody.innerHTML += `<tr><td>${e.d}</td><td>${e.n}</td><td>${e.w}</td><td>${e.r}</td></tr>`;
});

const maxMap = {};
data.forEach(e=>{
  if(!maxMap[e.n] || e.w > maxMap[e.n].w || (e.w===maxMap[e.n].w && e.r>maxMap[e.n].r)){
    maxMap[e.n]=e;
  }
});
const maxBody = document.querySelector("#maxWeightTable tbody");
Object.values(maxMap).forEach(e=>{
  maxBody.innerHTML += `<tr><td>${e.n}</td><td>${e.w}</td><td>${e.r}</td><td>${e.d}</td></tr>`;
});

const repMap = {};
data.forEach(e=>{
  const key = e.n+"_"+e.w;
  if(!repMap[key] || e.r > repMap[key].r){
    repMap[key]=e;
  }
});
const repBody = document.querySelector("#repMaxTable tbody");
Object.values(repMap).forEach(e=>{
  repBody.innerHTML += `<tr><td>${e.n}</td><td>${e.w}</td><td>${e.r}</td></tr>`;
});
</script>

</body>
</html>
